{"remainingRequest":"C:\\Users\\BINE\\Desktop\\JS_HW\\master\\js-w7\\project\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\BINE\\Desktop\\JS_HW\\master\\js-w7\\project\\src\\views\\admin\\Orders.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\BINE\\Desktop\\JS_HW\\master\\js-w7\\project\\src\\views\\admin\\Orders.vue","mtime":1596365197706},{"path":"C:\\Users\\BINE\\Desktop\\JS_HW\\master\\js-w7\\project\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\BINE\\Desktop\\JS_HW\\master\\js-w7\\project\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\BINE\\Desktop\\JS_HW\\master\\js-w7\\project\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\BINE\\Desktop\\JS_HW\\master\\js-w7\\project\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\BINE\\Desktop\\JS_HW\\master\\js-w7\\project\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQovLyDovInlhaUgUGFnaW5hdGlvbiDliIbpoIEgY29tcG9uZW50cw0KaW1wb3J0IFBhZ2luYXRpb24gZnJvbSAnQC9jb21wb25lbnRzL1BhZ2luYXRpb24udnVlJw0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAnT3JkZXJzJywNCiAgY29tcG9uZW50czogew0KICAgIFBhZ2luYXRpb24NCiAgfSwNCiAgZGF0YSAoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIG9yZGVyczoge30sDQogICAgICBwYWdpbmF0aW9uOiB7fSwNCiAgICAgIGlzTG9hZGluZzogZmFsc2UNCiAgICB9DQogIH0sDQogIGNyZWF0ZWQgKCkgew0KICAgIHRoaXMuZ2V0T3JkZXJzKCkNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGdldE9yZGVycyAocGFnZSA9IDEsIHBhZ2VkID0gOCkgew0KICAgICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlDQogICAgICBjb25zdCBhcGkgPSBgJHtwcm9jZXNzLmVudi5WVUVfQVBQX0FQSVBBVEh9LyR7cHJvY2Vzcy5lbnYuVlVFX0FQUF9VVUlEfS9hZG1pbi9lYy9vcmRlcnM/cGFnZT0ke3BhZ2V9JnBhZ2VkPSR7cGFnZWR9YA0KICAgICAgLy8gICBjb25zdCBwYXJhbXMgPSB7DQogICAgICAvLyAgICAgJ3BhZ2UnOiAnMScsDQogICAgICAvLyAgICAgJ3BhZ2VkJzogJzI1JywNCiAgICAgIC8vICAgICAnb3JkZXJCeSc6ICdjcmVhdGVkX2F0LCB1cGRhdGVkX2F0JywNCiAgICAgIC8vICAgICAnc29ydCc6ICdkZXNjLCBhc2MnDQogICAgICAvLyAgIH0NCiAgICAgIC8vICAgT2JqZWN0LmtleXMocGFyYW1zKQ0KICAgICAgLy8gICAgIC5mb3JFYWNoKGtleSA9PiBhcGkuc2VhcmNoUGFyYW1zLmFwcGVuZChrZXksIHBhcmFtc1trZXldKSkNCiAgICAgIHRoaXMuJGh0dHAuZ2V0KGFwaSkudGhlbigocmVzcG9uc2UpID0+IHsNCiAgICAgICAgdGhpcy5vcmRlcnMgPSByZXNwb25zZS5kYXRhLmRhdGENCiAgICAgICAgdGhpcy5wYWdpbmF0aW9uID0gcmVzcG9uc2UuZGF0YS5tZXRhLnBhZ2luYXRpb24NCiAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5vcmRlcnMpDQogICAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2UNCiAgICAgIH0pDQogICAgfSwNCiAgICBzZXRPcmRlclBhaWQgKGl0ZW0pIHsNCiAgICAgIGxldCBhcGkgPSBgJHtwcm9jZXNzLmVudi5WVUVfQVBQX0FQSVBBVEh9LyR7cHJvY2Vzcy5lbnYuVlVFX0FQUF9VVUlEfS9hZG1pbi9lYy9vcmRlcnMvJHtpdGVtLmlkfS9wYWlkYA0KICAgICAgaWYgKCFpdGVtLnBhaWQpIHsNCiAgICAgICAgYXBpID0gYCR7cHJvY2Vzcy5lbnYuVlVFX0FQUF9BUElQQVRIfS8ke3Byb2Nlc3MuZW52LlZVRV9BUFBfVVVJRH0vYWRtaW4vZWMvb3JkZXJzLyR7aXRlbS5pZH0vdW5wYWlkYA0KICAgICAgfQ0KICAgICAgdGhpcy4kaHR0cC5wYXRjaChhcGksIGl0ZW0uaWQpLnRoZW4oKHJlc3BvbnNlKSA9PiB7DQogICAgICAgIGNvbnNvbGUubG9nKCflt7Lku5jmrL4nKQ0KICAgICAgICB0aGlzLmdldE9yZGVycygpDQogICAgICB9KQ0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["Orders.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Orders.vue","sourceRoot":"src/views/admin","sourcesContent":["<template>\r\n    <div>\r\n        <loading :active.sync=\"isLoading\"></loading>\r\n        <table class=\"table\">\r\n            <thead>\r\n                <tr>\r\n                    <th>下單時間</th>\r\n                    <th>購買款項</th>\r\n                    <th>付款方式</th>\r\n                    <th>應付金額</th>\r\n                    <th>是否付款</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody v-if = \"orders.length\">\r\n                <tr v-for=\"(item, index) in orders\"\r\n                    :key=\"index\"\r\n                    :class=\"{'text-danger': !item.paid}\"\r\n                    >\r\n                    <td>{{ item.created.datetime }}</td>\r\n                    <td>\r\n                        <ul class=\"list-unstyled\">\r\n                            <li v-for=\"(product, index) in item.products\"\r\n                            :key=\"index\"\r\n                            >\r\n                                {{ product.product.title}} 數量 : {{ product.quantity }} {{ product.product.unit }}\r\n                            </li>\r\n                        </ul>\r\n                    </td>\r\n                    <td>{{ item.payment }}</td>\r\n                    <td>{{ item.amount | money }}</td>\r\n                    <td>\r\n                        <div class=\"custom-control custom-switch\">\r\n                            <input\r\n                                :id=\"item.id\"\r\n                                v-model=\"item.paid\"\r\n                                type=\"checkbox\"\r\n                                class=\"custom-control-input\"\r\n                                @change=\"setOrderPaid(item)\"\r\n                            >\r\n                            <label\r\n                                class=\"custom-control-label\"\r\n                                :for=\"item.id\"\r\n                            >\r\n                                <strong\r\n                                v-if=\"item.paid\"\r\n                                class=\"text-success\"\r\n                                >已付款</strong>\r\n                                <span\r\n                                v-else\r\n                                class=\"text-muted\"\r\n                                >尚未付款</span>\r\n                            </label>\r\n                        </div>\r\n                    </td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n         <!-- 分頁元件 :pages 取得外層 pagination 頁面資訊 ; @emit-pages 刷新頁面-->\r\n        <div class=\"d-flex justify-content-center\">\r\n          <Pagination :pages=\"pagination\" @emit-pages=\"getOrders\"></Pagination>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n// 載入 Pagination 分頁 components\r\nimport Pagination from '@/components/Pagination.vue'\r\nexport default {\r\n  name: 'Orders',\r\n  components: {\r\n    Pagination\r\n  },\r\n  data () {\r\n    return {\r\n      orders: {},\r\n      pagination: {},\r\n      isLoading: false\r\n    }\r\n  },\r\n  created () {\r\n    this.getOrders()\r\n  },\r\n  methods: {\r\n    getOrders (page = 1, paged = 8) {\r\n      this.isLoading = true\r\n      const api = `${process.env.VUE_APP_APIPATH}/${process.env.VUE_APP_UUID}/admin/ec/orders?page=${page}&paged=${paged}`\r\n      //   const params = {\r\n      //     'page': '1',\r\n      //     'paged': '25',\r\n      //     'orderBy': 'created_at, updated_at',\r\n      //     'sort': 'desc, asc'\r\n      //   }\r\n      //   Object.keys(params)\r\n      //     .forEach(key => api.searchParams.append(key, params[key]))\r\n      this.$http.get(api).then((response) => {\r\n        this.orders = response.data.data\r\n        this.pagination = response.data.meta.pagination\r\n        // console.log(this.orders)\r\n        this.isLoading = false\r\n      })\r\n    },\r\n    setOrderPaid (item) {\r\n      let api = `${process.env.VUE_APP_APIPATH}/${process.env.VUE_APP_UUID}/admin/ec/orders/${item.id}/paid`\r\n      if (!item.paid) {\r\n        api = `${process.env.VUE_APP_APIPATH}/${process.env.VUE_APP_UUID}/admin/ec/orders/${item.id}/unpaid`\r\n      }\r\n      this.$http.patch(api, item.id).then((response) => {\r\n        console.log('已付款')\r\n        this.getOrders()\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]}]}