{"remainingRequest":"C:\\Users\\BINE\\Desktop\\JS_HW\\master\\js-w6\\project\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\BINE\\Desktop\\JS_HW\\master\\js-w6\\project\\src\\views\\admin\\Products.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\BINE\\Desktop\\JS_HW\\master\\js-w6\\project\\src\\views\\admin\\Products.vue","mtime":1595913993180},{"path":"C:\\Users\\BINE\\Desktop\\JS_HW\\master\\js-w6\\project\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\BINE\\Desktop\\JS_HW\\master\\js-w6\\project\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\BINE\\Desktop\\JS_HW\\master\\js-w6\\project\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\BINE\\Desktop\\JS_HW\\master\\js-w6\\project\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQovLyDovInlhaUgUGFnaW5hdGlvbiDliIbpoIEgY29tcG9uZW50cw0KaW1wb3J0IFBhZ2luYXRpb24gZnJvbSAnQC9jb21wb25lbnRzL1BhZ2luYXRpb24udnVlJw0KLy8g6LyJ5YWlUHJvZHVjdE1vZGFsIGNvbXBvbmVudHMNCmltcG9ydCBQcm9kdWN0TW9kYWwgZnJvbSAnQC9jb21wb25lbnRzL1Byb2R1Y3RNb2RhbC52dWUnDQovLyBpbXBvcnQgJCBmcm9tICdqcXVlcnknIC8vIFNURVAgMe+8mui8ieWFpSBqUXVlcnkNCi8vIOi8ieWFpSBEZWxQcm9kdWN0TW9kYWwgY29tcG9uZW50cw0KaW1wb3J0IERlbFByb2R1Y3RNb2RhbCBmcm9tICdAL2NvbXBvbmVudHMvRGVsUHJvZHVjdE1vZGFsLnZ1ZScNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogJ1Byb2R1Y3RzJywNCiAgY29tcG9uZW50czogew0KICAgIFBhZ2luYXRpb24sDQogICAgUHJvZHVjdE1vZGFsLA0KICAgIERlbFByb2R1Y3RNb2RhbA0KICB9LA0KICBkYXRhICgpIHsNCiAgICByZXR1cm4gew0KICAgICAgaXNMb2FkaW5nOiBmYWxzZSwNCiAgICAgIHByb2R1Y3RzOiBbXSwNCiAgICAgIHBhZ2luYXRpb246IHt9LA0KICAgICAgdGVtcFByb2R1Y3Q6IHsNCiAgICAgICAgaW1hZ2VVcmw6IFtdLA0KICAgICAgICBvcHRpb25zOiB7fQ0KICAgICAgfSwNCiAgICAgIGlzTmV3OiB0cnVlLA0KICAgICAgc3RhdHVzOiB7DQogICAgICAgIGZpbGVVcGxvYWRpbmc6IGZhbHNlDQogICAgICB9LA0KICAgICAgbG9hZGluZ0J0bjogJycNCiAgICB9DQogIH0sDQogIGNyZWF0ZWQgKCkgew0KICAgIHRoaXMuZ2V0UHJvZHVjdHMoKQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgZ2V0UHJvZHVjdHMgKHBhZ2UgPSAxKSB7DQogICAgICB0aGlzLmlzTG9hZGluZyA9IHRydWUNCiAgICAgIGNvbnN0IGFwaSA9IGAke3Byb2Nlc3MuZW52LlZVRV9BUFBfQVBJUEFUSH0vJHtwcm9jZXNzLmVudi5WVUVfQVBQX1VVSUR9L2FkbWluL2VjL3Byb2R1Y3RzP3BhZ2U9JHtwYWdlfWANCiAgICAgIC8vIGNvbnN0IGFwaSA9IGAke3Byb2Nlc3MuZW52LlZVRV9BUFBfQVBJUEFUSH0vJHtwcm9jZXNzLmVudi5WVUVfQVBQX1VVSUR9L2VjL3Byb2R1Y3RzYA0KICAgICAgLy8gY29uc29sZS5sb2coYXBpKQ0KICAgICAgdGhpcy5heGlvcy5nZXQoYXBpKS50aGVuKChyZXNwb25zZSkgPT4gew0KICAgICAgICB0aGlzLnByb2R1Y3RzID0gcmVzcG9uc2UuZGF0YS5kYXRhDQogICAgICAgIC8vIOWwh+mBoOerr+mggeaVuOWbnuaHieizh+aWmeWtmOWFpeeUouWTgemggeaVuOizh+aWmeS4pue1piBwYWdpbmF0aW9uIOWFg+S7tuWBmuW+jOe6jOiZleeQhg0KICAgICAgICB0aGlzLnBhZ2luYXRpb24gPSByZXNwb25zZS5kYXRhLm1ldGEucGFnaW5hdGlvbg0KICAgICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlDQogICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMucHJvZHVjdHMpDQogICAgICB9KQ0KICAgIH0sDQogICAgb3Blbk1vZGFsIChhY3QsIGl0ZW0pIHsNCiAgICAgIHN3aXRjaCAoYWN0KSB7DQogICAgICAgIGNhc2UgJ25ldyc6DQogICAgICAgICAgLy8g5L2/55SoIHJlZnMg6Ke455m85a2Q5YWD5Lu25riF56m6DQogICAgICAgICAgdGhpcy4kcmVmcy5wcm9kdWN0TW9kZWwudGVtcFByb2R1Y3QgPSB7DQogICAgICAgICAgICBpbWFnZVVybDogW10sDQogICAgICAgICAgICBvcHRpb25zOiB7fSAvLyDoh6rooYzmlrDlop7nm7jpl5zmrITkvY3kuqbkuIDkvbXmuIXnqboNCiAgICAgICAgICB9DQogICAgICAgICAgLy8gMjAyMDA35pS55oiQ5qih57WE5YWn6YCP6YGOIGlzTmV3IOS+huWIpOaWtyA6Y2xhc3Mg77yM6LyD54K657Ch5r2UDQogICAgICAgICAgLy8gdGhpcy5tb2RhbENsYXNzWydiZy1wcmltYXJ5J10gPSB0cnVlOw0KICAgICAgICAgIC8vIHRoaXMubW9kYWxDbGFzc1snYmctc3VjY2VzcyddID0gZmFsc2U7DQogICAgICAgICAgdGhpcy5pc05ldyA9IHRydWUNCiAgICAgICAgICB3aW5kb3cuJCgnI3Byb2R1Y3RNb2RhbCcpLm1vZGFsKCdzaG93JykNCiAgICAgICAgICAvLyAgIHRoaXMuJHJlZnNbJ3Byb2R1Y3QtTW9kZWwnXS5zaG93KCkNCiAgICAgICAgICBicmVhaw0KICAgICAgICBjYXNlICdlZGl0JzoNCiAgICAgICAgICAvLyAyMDIwMDfmlLnmiJDmqKHntYTlhafpgI/pgY4gaXNOZXcg5L6G5Yik5pa3IDpjbGFzcyDvvIzovIPngrrnsKHmvZQNCiAgICAgICAgICAvLyB0aGlzLm1vZGFsQ2xhc3NbJ2JnLXByaW1hcnknXSA9IGZhbHNlOw0KICAgICAgICAgIC8vIHRoaXMubW9kYWxDbGFzc1snYmctc3VjY2VzcyddID0gdHJ1ZTsNCiAgICAgICAgICAvLyB0aGlzLmlzTG9hZGluZyA9IHRydWU7DQogICAgICAgICAgdGhpcy5sb2FkaW5nQnRuID0gdGhpcy50ZW1wUHJvZHVjdC5pZA0KICAgICAgICAgIHRoaXMuaXNOZXcgPSBmYWxzZQ0KICAgICAgICAgIHRoaXMudGVtcFByb2R1Y3QgPSBPYmplY3QuYXNzaWduKHt9LCBpdGVtKQ0KICAgICAgICAgIC8vIHRoaXMudGVtcFByb2R1Y3QgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGl0ZW0pKTsNCiAgICAgICAgICAvLyDkvb/nlKggcmVmcyDop7jnmbzlrZDlhYPku7ZnZXRQcm9kdWN05pa55rOVDQogICAgICAgICAgdGhpcy4kcmVmcy5wcm9kdWN0TW9kZWwuZ2V0UHJvZHVjdCh0aGlzLnRlbXBQcm9kdWN0LmlkKQ0KICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMudGVtcFByb2R1Y3QuaWQpDQogICAgICAgICAgd2luZG93LiQoJyNwcm9kdWN0TW9kYWwnKS5tb2RhbCgnc2hvdycpDQogICAgICAgICAgdGhpcy5sb2FkaW5nQnRuID0gJycNCiAgICAgICAgICAvLyB0aGlzLmlzTG9hZGluZyA9IGZhbHNlOw0KICAgICAgICAgIGJyZWFrDQogICAgICAgIGNhc2UgJ2RlbGV0ZSc6DQogICAgICAgICAgdGhpcy50ZW1wUHJvZHVjdCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoaXRlbSkpDQogICAgICAgICAgd2luZG93LiQoJyNkZWxQcm9kdWN0TW9kYWwnKS5tb2RhbCgnc2hvdycpDQogICAgICAgICAgYnJlYWsNCiAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICBicmVhaw0KICAgICAgfQ0KICAgIH0sDQogICAgLy8g6Kit5a6a55Si5ZOB5ZWf55So5Ye95byPDQogICAgc2V0UHJvZHVjdEVuYWJsZWQgKGl0ZW0pIHsNCiAgICAgIHRoaXMubG9hZGluZ0J0biA9IGl0ZW0uaWQNCiAgICAgIC8vIDEu5rex5bGk6KSH6KO95Zau562G55Si5ZOB6LOH5paZ6Iez5pqr5a2YIHRlbXBQcm9kdWN0DQogICAgICB0aGlzLnRlbXBQcm9kdWN0ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShpdGVtKSkNCiAgICAgIC8vIDIu6Kit5a6aQVBJ5L2N572uDQogICAgICBjb25zdCBhcGkgPSBgJHtwcm9jZXNzLmVudi5WVUVfQVBQX0FQSVBBVEh9LyR7cHJvY2Vzcy5lbnYuVlVFX0FQUF9VVUlEfS9hZG1pbi9lYy9wcm9kdWN0LyR7dGhpcy50ZW1wUHJvZHVjdC5pZH1gDQogICAgICAvLyAzLuioreWumuaYr+WQpuS4iuaetu+8jOWmguaenOW3suS4iuaetu+8jOioreWumueCuuS4i+aetu+8jOWPjeS5i+ioreWumueCuuS4iuaetg0KICAgICAgaWYgKHRoaXMudGVtcFByb2R1Y3QuZW5hYmxlZCkgew0KICAgICAgICB0aGlzLnRlbXBQcm9kdWN0LmVuYWJsZWQgPSBmYWxzZQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy50ZW1wUHJvZHVjdC5lbmFibGVkID0gdHJ1ZQ0KICAgICAgfQ0KICAgICAgLy8gNC7kvb/nlKggYXhpb3MucGF0Y2ggQVBJIOmdnuWQjOatpeabtOaWsOmBoOerr+izh+aWmQ0KICAgICAgdGhpcy5heGlvcy5wYXRjaChhcGksIHRoaXMudGVtcFByb2R1Y3QpLnRoZW4oKCkgPT4gew0KICAgICAgICB0aGlzLmxvYWRpbmdCdG4gPSAnJw0KICAgICAgICAvLyA1LuabtOaWsOWujOaIkOW+jOWNs+WIt+aWsOeUouWTgeWIl+ihqA0KICAgICAgICB0aGlzLmdldFByb2R1Y3RzKCkNCiAgICAgIH0pLmNhdGNoKChlcnJvcikgPT4gew0KICAgICAgICBjb25zb2xlLmxvZyhlcnJvcikNCiAgICAgIH0pDQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["Products.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Products.vue","sourceRoot":"src/views/admin","sourcesContent":["<template>\r\n    <div class=\"products\">\r\n        <div class=\"text-right mt-3\">\r\n                <button @click=\"openModal('new')\" class=\"btn btn-outline-primary\">\r\n                <!-- <i class=\"material-icons align-middle\">add_circle </i> -->\r\n                <font-awesome-icon icon=\"plus-square\"/>\r\n                <span class=\"align-middle\"> 新增產品</span>\r\n            </button>\r\n        </div>\r\n        <table class=\"table mt-4\">\r\n            <thead>\r\n                <tr>\r\n                    <th width=\"150\">分類</th>\r\n                    <th>產品名稱</th>\r\n                    <th width=\"120\">原價</th>\r\n                    <th width=\"100\">售價</th>\r\n                    <th width=\"120\">是否上架</th>\r\n                    <th width=\"120\">編輯 / 刪除</th>\r\n                </tr>\r\n            </thead>\r\n            <!-- 列出產品 -->\r\n            <tbody>\r\n                <tr v-for=\"(item) in products\" :key=\"item.id\">\r\n                    <td>{{ item.category }}</td>\r\n                    <td>{{ item.title }}</td>\r\n                    <td>{{ item.origin_price | money }}</td>\r\n                    <td>{{ item.price | money }}</td>\r\n                    <td>\r\n                        <span v-if=\"item.enabled\" class=\"text-success d-flex align-items-center justify-content-center\">\r\n                            <a @click=\"setProductEnabled(item)\" class=\"btn text-success p-0\" href=\"#\" role=\"button\" :class=\"{'disabled':loadingBtn === item.id}\">\r\n                                <!-- <i class=\"material-icons font-size-36\">toggle_on </i> -->\r\n                                <font-awesome-icon icon=\"toggle-off\"/>\r\n                                <sup v-if='loadingBtn === item.id' class=\"spinner-grow spinner-grow-sm text-success\" role=\"status\">\r\n                                </sup>\r\n                                <sup v-else > on</sup>\r\n                            </a>\r\n                        </span>\r\n                        <span v-else class=\"text-danger d-flex align-items-center justify-content-center\">\r\n                            <a @click=\"setProductEnabled(item)\" class=\"btn text-danger p-0\" href=\"#\" role=\"button\" :class=\"{'disabled':loadingBtn === item.id}\">\r\n                                <!-- <i class=\"material-icons font-size-36\">toggle_off </i> -->\r\n                                <font-awesome-icon icon=\"toggle-on\"/>\r\n                                <sub v-if='loadingBtn === item.id' class=\"spinner-grow spinner-grow-sm text-danger\" role=\"status\"></sub>\r\n                                <sub v-else > off</sub>\r\n                            </a>\r\n                        </span>\r\n                    </td>\r\n                    <td>\r\n                        <!-- 修改即刪除按鈕，使用v-on:click @click -->\r\n                        <div class=\"btn-group\">\r\n                            <button v-on:click=\"openModal('edit', item)\" class=\"btn btn-outline-success py-1\">\r\n                                <!-- <i class=\"material-icons align-middle\">edit</i> -->\r\n                                <font-awesome-icon icon=\"edit\"/>\r\n                            </button>\r\n                            <button @click=\"openModal('delete', item)\" class=\"btn btn-outline-danger py-1\">\r\n                                <!-- <i class=\"material-icons align-middle\">delete_forever</i> -->\r\n                                <font-awesome-icon icon=\"trash-alt\"/>\r\n                            </button>\r\n                        </div>\r\n                    </td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n        <!-- 分頁元件 :pages 取得外層 pagination 頁面資訊 ; @emit-pages 刷新頁面-->\r\n        <Pagination :pages=\"pagination\" @emit-pages=\"getProducts\"></Pagination>\r\n         <!-- Modal -->\r\n        <product-modal ref=\"productModel\" :status=\"status\" :is-new=\"isNew\" @update=\"getProducts\">\r\n        </product-modal>\r\n        <!-- props tempProduct id,title user ; @update 呼叫getProducts-->\r\n        <del-product-modal :temp-product=\"tempProduct\"  @update=\"getProducts\"></del-product-modal>\r\n        <!-- Vue Loading Overlay Component -->\r\n        <loading :active.sync=\"isLoading\"></loading>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n// 載入 Pagination 分頁 components\r\nimport Pagination from '@/components/Pagination.vue'\r\n// 載入ProductModal components\r\nimport ProductModal from '@/components/ProductModal.vue'\r\n// import $ from 'jquery' // STEP 1：載入 jQuery\r\n// 載入 DelProductModal components\r\nimport DelProductModal from '@/components/DelProductModal.vue'\r\nexport default {\r\n  name: 'Products',\r\n  components: {\r\n    Pagination,\r\n    ProductModal,\r\n    DelProductModal\r\n  },\r\n  data () {\r\n    return {\r\n      isLoading: false,\r\n      products: [],\r\n      pagination: {},\r\n      tempProduct: {\r\n        imageUrl: [],\r\n        options: {}\r\n      },\r\n      isNew: true,\r\n      status: {\r\n        fileUploading: false\r\n      },\r\n      loadingBtn: ''\r\n    }\r\n  },\r\n  created () {\r\n    this.getProducts()\r\n  },\r\n  methods: {\r\n    getProducts (page = 1) {\r\n      this.isLoading = true\r\n      const api = `${process.env.VUE_APP_APIPATH}/${process.env.VUE_APP_UUID}/admin/ec/products?page=${page}`\r\n      // const api = `${process.env.VUE_APP_APIPATH}/${process.env.VUE_APP_UUID}/ec/products`\r\n      // console.log(api)\r\n      this.axios.get(api).then((response) => {\r\n        this.products = response.data.data\r\n        // 將遠端頁數回應資料存入產品頁數資料並給 pagination 元件做後續處理\r\n        this.pagination = response.data.meta.pagination\r\n        this.isLoading = false\r\n        // console.log(this.products)\r\n      })\r\n    },\r\n    openModal (act, item) {\r\n      switch (act) {\r\n        case 'new':\r\n          // 使用 refs 觸發子元件清空\r\n          this.$refs.productModel.tempProduct = {\r\n            imageUrl: [],\r\n            options: {} // 自行新增相關欄位亦一併清空\r\n          }\r\n          // 202007改成模組內透過 isNew 來判斷 :class ，較為簡潔\r\n          // this.modalClass['bg-primary'] = true;\r\n          // this.modalClass['bg-success'] = false;\r\n          this.isNew = true\r\n          window.$('#productModal').modal('show')\r\n          //   this.$refs['product-Model'].show()\r\n          break\r\n        case 'edit':\r\n          // 202007改成模組內透過 isNew 來判斷 :class ，較為簡潔\r\n          // this.modalClass['bg-primary'] = false;\r\n          // this.modalClass['bg-success'] = true;\r\n          // this.isLoading = true;\r\n          this.loadingBtn = this.tempProduct.id\r\n          this.isNew = false\r\n          this.tempProduct = Object.assign({}, item)\r\n          // this.tempProduct = JSON.parse(JSON.stringify(item));\r\n          // 使用 refs 觸發子元件getProduct方法\r\n          this.$refs.productModel.getProduct(this.tempProduct.id)\r\n          // console.log(this.tempProduct.id)\r\n          window.$('#productModal').modal('show')\r\n          this.loadingBtn = ''\r\n          // this.isLoading = false;\r\n          break\r\n        case 'delete':\r\n          this.tempProduct = JSON.parse(JSON.stringify(item))\r\n          window.$('#delProductModal').modal('show')\r\n          break\r\n        default:\r\n          break\r\n      }\r\n    },\r\n    // 設定產品啟用函式\r\n    setProductEnabled (item) {\r\n      this.loadingBtn = item.id\r\n      // 1.深層複製單筆產品資料至暫存 tempProduct\r\n      this.tempProduct = JSON.parse(JSON.stringify(item))\r\n      // 2.設定API位置\r\n      const api = `${process.env.VUE_APP_APIPATH}/${process.env.VUE_APP_UUID}/admin/ec/product/${this.tempProduct.id}`\r\n      // 3.設定是否上架，如果已上架，設定為下架，反之設定為上架\r\n      if (this.tempProduct.enabled) {\r\n        this.tempProduct.enabled = false\r\n      } else {\r\n        this.tempProduct.enabled = true\r\n      }\r\n      // 4.使用 axios.patch API 非同步更新遠端資料\r\n      this.axios.patch(api, this.tempProduct).then(() => {\r\n        this.loadingBtn = ''\r\n        // 5.更新完成後即刷新產品列表\r\n        this.getProducts()\r\n      }).catch((error) => {\r\n        console.log(error)\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]}]}